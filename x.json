{
  "name": "webrtc",
  "description": "WebRTC for ChiÏ‡",
  "version": "0.0.2",
  "repository": {
    "type": "git",
    "url": "https://github.com/nodule/webrtc.git"
  },
  "dependencies": {
    "webrtc": "x.x.x",
    "hark": "x.x.x",
    "getusermedia": "x.x.x",
    "attachmediastream": "x.x.x"
  },
  "nodes": [
    {
      "name": "attachMediaStream",
      "ns": "webrtc",
      "description": "AttachMediaStream (microphone, camera)",
      "phrases": {
        "active": "Attaching Media Stream"
      },
      "require": {
        "attachmediastream": "latest"
      },
      "ports": {
        "input": {
          "element": {
            "title": "Media Element",
            "type": "any"
          },
          "stream": {
            "title": "Stream",
            "type": "function"
          }
        },
        "output": {
          "element": {
            "title": "Media Element",
            "type": "any"
          },
          "stream": {
            "title": "Stream",
            "type": "function"
          }
        }
      },
      "fn": "attachmediastream(input.element, input.stream)\noutput = input\n"
    },
    {
      "name": "createPeer",
      "ns": "webrtc",
      "description": "Create Peer",
      "phrases": {
        "active": "Creating Peer"
      },
      "ports": {
        "input": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function",
            "required": true
          },
          "id": {
            "title": "ID",
            "type": "string"
          },
          "type": {
            "title": "Type",
            "type": "string",
            "enum": [
              "video",
              "audio",
              "screen"
            ],
            "default": "video"
          },
          "oneway": {
            "title": "One Way?",
            "type": "boolean",
            "default": false
          },
          "sharemyscreen": {
            "title": "Share My Screen",
            "type": "boolean",
            "default": false
          },
          "stream": {
            "title": "WebRTC Stream",
            "type": "function"
          }
        },
        "output": {
          "peer": {
            "title": "Peer",
            "type": "function"
          }
        }
      },
      "fn": "webrtc = input.webrtc;\ndelete input.webrtc;\noutput = { peer: webrtc.createPeer(input) };\n"
    },
    {
      "name": "getUserMedia",
      "ns": "webrtc",
      "description": "Get User Media (microphone, camera)",
      "phrases": {
        "active": "Getting User Media"
      },
      "require": {
        "getusermedia": "latest"
      },
      "ports": {
        "input": {},
        "output": {
          "error": {
            "title": "Error",
            "type": "object"
          },
          "stream": {
            "title": "Stream",
            "type": "function"
          }
        }
      },
      "fn": "var speachEvents = hark(input.stream);\n\noutput = function(cb) {\n\n  speechEvents.on('speaking', function() {\n    cb({ speaking: true });\n  });\n\n  speechEvents.on('volume_change', function(volume, threshold) {\n    cb({ volume: volume, treshold: treshold});\n  });\n\n  speechEvents.on('stopped_speaking', function() {\n    cb({ speaking: false });\n  });\n\n};\n"
    },
    {
      "name": "hark",
      "ns": "webrtc",
      "description": "Hark",
      "phrases": {
        "active": "Harking"
      },
      "require": {
        "hark": "latest"
      },
      "ports": {
        "input": {
          "stream": {
            "title": "Stream",
            "type": "function",
            "description": "e.g. document.querySelector('audio')",
            "required": true
          }
        },
        "output": {
          "speaking": {
            "title": "Speaking",
            "type": "boolean"
          },
          "volume": {
            "title": "volume",
            "type": "number"
          },
          "threshold": {
            "title": "Treshold",
            "type": "number"
          }
        }
      },
      "fn": "var speachEvents = hark(input.stream);\n\noutput = function(cb) {\n\n  speechEvents.on('speaking', function() {\n    cb({ speaking: true });\n  });\n\n  speechEvents.on('volume_change', function(volume, threshold) {\n    cb({ volume: volume, treshold: treshold});\n  });\n\n  speechEvents.on('stopped_speaking', function() {\n    cb({ speaking: false });\n  });\n\n};\n"
    },
    {
      "name": "mute",
      "ns": "webrtc",
      "description": "Mute",
      "phrases": {
        "active": "Muting media"
      },
      "ports": {
        "input": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function",
            "required": true
          }
        },
        "output": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function"
          }
        }
      },
      "fn": "input.webrtc.mute();\noutput = { webrtc: input.webrtc };\n"
    },
    {
      "name": "pause",
      "ns": "webrtc",
      "description": "Pause",
      "phrases": {
        "active": "Pausing"
      },
      "ports": {
        "input": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function",
            "required": true
          }
        },
        "output": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function"
          }
        }
      },
      "fn": "input.webrtc.pause();\noutput = { webrtc: input.webrtc };\n"
    },
    {
      "name": "pauseVideo",
      "ns": "webrtc",
      "description": "Pause Video",
      "phrases": {
        "active": "Pausing video"
      },
      "ports": {
        "input": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function",
            "required": true
          }
        },
        "output": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function"
          }
        }
      },
      "fn": "input.webrtc.pauseVideo();\noutput = { webrtc: input.webrtc };\n"
    },
    {
      "name": "resume",
      "ns": "webrtc",
      "description": "Resume",
      "phrases": {
        "active": "Resuming"
      },
      "ports": {
        "input": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function",
            "required": true
          }
        },
        "output": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function"
          }
        }
      },
      "fn": "input.webrtc.resume();\noutput = { webrtc: input.webrtc };\n"
    },
    {
      "name": "resumeVideo",
      "ns": "webrtc",
      "description": "Resume Video",
      "phrases": {
        "active": "Resuming video"
      },
      "ports": {
        "input": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function",
            "required": true
          }
        },
        "output": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function"
          }
        }
      },
      "fn": "input.webrtc.resumeVideo();\noutput = { webrtc: input.webrtc };\n"
    },
    {
      "name": "startLocalMedia",
      "ns": "webrtc",
      "description": "Start Local Media",
      "phrases": {
        "active": "Starting local media"
      },
      "ports": {
        "input": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function",
            "required": true
          },
          "media": {
            "type": "object",
            "properties": {
              "audio": {
                "title": "Audio?",
                "type": "boolean",
                "default": true
              },
              "video": {
                "title": "Video?",
                "type": "boolean",
                "default": true
              }
            }
          }
        },
        "output": {
          "error": {
            "title": "Error",
            "type": "object"
          },
          "stream": {
            "title": "Stream",
            "type": "function"
          }
        }
      },
      "fn": "output = [input.webrtc, 'startLocalMedia', input.media];\n"
    },
    {
      "name": "stopLocalMedia",
      "ns": "webrtc",
      "description": "Stop Local Media",
      "phrases": {
        "active": "Stopping local media"
      },
      "ports": {
        "input": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function",
            "required": true
          }
        },
        "output": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function"
          }
        }
      },
      "fn": "input.webrtc.stopLocalMedia();\noutput = { webrtc: input.webrtc };\n"
    },
    {
      "name": "unmute",
      "ns": "webrtc",
      "description": "Unmute",
      "phrases": {
        "active": "Unmuting media"
      },
      "ports": {
        "input": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function",
            "required": true
          }
        },
        "output": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function"
          }
        }
      },
      "fn": "input.webrtc.unmute();\noutput = { webrtc: input.webrtc };\n"
    },
    {
      "name": "webrtc",
      "ns": "webrtc",
      "description": "WebRTC",
      "phrases": {
        "active": "Launching WebRTC!"
      },
      "require": {
        "webrtc": "latest"
      },
      "ports": {
        "input": {
          "debug": {
            "title": "Debug",
            "type": "boolean",
            "default": false
          },
          "localVideoEl": {
            "title": "Local Video Element",
            "type": "any",
            "required": true
          },
          "remoteVideosEl": {
            "title": "Remote Videos Element",
            "type": "any",
            "required": true
          },
          "autoRequestMedia": {
            "title": "Auto Request Media",
            "type": "boolean",
            "default": false
          },
          "autoAdjustMic": {
            "title": "Auto Adjust Microphone",
            "type": "boolean",
            "default": false
          },
          "media": {
            "type": "object",
            "properties": {
              "audio": {
                "title": "Audio?",
                "type": "boolean",
                "default": true
              },
              "video": {
                "title": "Video?",
                "type": "boolean",
                "default": true
              }
            }
          },
          "detectSpeakingEvents": {
            "title": "Detect Speaking Events",
            "type": "boolean",
            "default": true
          },
          "enableDataChannels": {
            "title": "Enable Data Channels",
            "type": "boolean",
            "default": true
          }
        },
        "output": {
          "webrtc": {
            "title": "WebRTC",
            "type": "function"
          },
          "localStream": {
            "title": "Local Stream",
            "type": "function"
          },
          "localStreamStopped": {
            "title": "Local Stream Stopped",
            "type": "boolean"
          },
          "audio": {
            "title": "Audio ON/OFF",
            "type": "boolean"
          },
          "video": {
            "title": "Video ON/OFF",
            "type": "boolean"
          },
          "speaking": {
            "title": "Speaking YES/NO",
            "type": "boolean"
          },
          "message": {
            "title": "Message",
            "type": "any"
          },
          "peerStreamAdded": {
            "title": "Peer Stream Added",
            "type": "function"
          },
          "peerStreamRemoved": {
            "title": "Peer Stream Removed",
            "type": "function"
          }
        }
      },
      "fn": "output = function(cb) {\n\n  var wrtc = new webrtc(input);\n\n  // our direct port.\n  cb({\n    webrtc: wrtc\n  });\n\n  // send local stream\n  wrtc.on('localStream', function(stream) {\n     cb({ localStream: stream });\n  });\n\n  wrtc.on('localStreamStopped', function() {\n     cb({ localStreamStopped: true });\n  });\n\n  wrtc.on('audioOn', function() {\n     cb({ audio: true });\n  });\n\n  wrtc.on('audioOff', function() {\n     cb({ audio: false });\n  });\n\n  wrtc.on('videoOn', function() {\n     cb({ video: true });\n  });\n\n  wrtc.on('videoOff', function() {\n     cb({ video: false });\n  });\n\n  wrtc.on('speaking', function() {\n     cb({ speaking: true });\n  });\n\n  wrtc.on('stoppedSpeaking', function() {\n     cb({ speaking: false });\n  });\n\n  wrtc.on('message', function(message) {\n     cb({ message: message });\n  });\n\n  wrtc.on('peerStreamAdded', function(peer) {\n     cb({ peerStreamAdded: peer });\n  });\n\n  wrtc.on('peerStreamRemoved', function(peer) {\n     cb({ peerStreamRemoved: peer });\n  });\n\n};\n"
    }
  ],
  "twigs": []
}